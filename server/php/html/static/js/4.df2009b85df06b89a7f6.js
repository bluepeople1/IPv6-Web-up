webpackJsonp([4],{239:function(t,e,a){var o=a(53)(a(741),a(765),null,null,null);t.exports=o.exports},259:function(t,e,a){t.exports={default:a(260),__esModule:!0}},260:function(t,e,a){a(55),a(54),t.exports=a(261)},261:function(t,e,a){var o=a(8),s=a(97);t.exports=a(6).getIterator=function(t){var e=s(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return o(e.call(t))}},266:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(259),s=a.n(o),n=a(96),i=a.n(n);e.default={props:{url:{type:String,required:!0},count:{type:Number,default:15},fun:{type:Function,default:null},init:{type:Boolean,default:!0},bLoading:{type:Boolean,default:!0}},data:function(){var t=1;"page"in this.$route.query&&(t=parseInt(this.$route.query.page));var e=this.$axios.CancelToken.source();return{data:[],total:0,page:t,param:{},m_count:this.count,sortName:"",sortType:0,cancel:e,loading:!1,m_lock:!1,waiting:!1}},watch:{page:function(t){var e=i()({},this.$route.query);e.page=t,this.$router.replace({query:e}),this.loadPage()}},methods:{loadPage:function(){var t=this;this.m_lock?console.log("send ignore"):(this.m_lock=!0,this.waiting&&(this.cancel.cancel(),this.cancel=this.$axios.CancelToken.source()),this.$nextTick(function(){t.waiting=!0,t.m_lock=!1;var e={page:t.page-1,count:t.m_count};""!=t.sortName&&(e.sortName=t.sortName,e.sortType=t.sortType),t.loading=t.bLoading,t.$axios({methods:"get",url:t.url,params:i()(e,t.param),Eload:!1,cancelToken:t.cancel.token}).then(function(e){var a=e.data;t.total=a.total,null!=t.fun&&(a.data=a.data.map(t.fun)),t.data=a.data,t.loading=!1,t.waiting=!1}).catch(function(){t.loading=!1,t.waiting=!1})}))},jump:function(t){if(t<=0||t>this.totalPage)return void this.$message.error("页码超出范围！");this.page=t},changeSort:function(t,e,a){this.sortName=e,this.sortType="descending"==a?0:1,this.reload()},changeSize:function(t){this.m_count=t,this.loadPage()},reload:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?1==this.page?this.loadPage():this.page=1:this.loadPage()},getRow:function(t,e){var a=!0,o=!1,n=void 0;try{for(var i,l=s()(this.data);!(a=(i=l.next()).done);a=!0){var r=i.value;if(r[t]==e)return r}}catch(t){o=!0,n=t}finally{try{!a&&l.return&&l.return()}finally{if(o)throw n}}return null},addParam:function(t,e){this.param[t]=e},delParam:function(t){delete this.param[t]}},created:function(){this.init&&this.loadPage()}}},267:function(t,e,a){e=t.exports=a(221)(!1),e.push([t.i,".el-pagination{text-align:right;margin-top:15px}",""])},269:function(t,e,a){var o=a(267);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a(222)("4fc6ddea",o,!0,{})},270:function(t,e,a){function o(t){a(269)}var s=a(53)(a(266),a(271),o,null,null);t.exports=s.exports},271:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.loading,expression:"loading",modifiers:{body:!0}}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.data,border:"","element-loading-text":"拼命加载中",stripe:!0},on:{"sort-change":t.changeSort}},[t._t("default")],2),t._v(" "),a("div",{staticClass:"pagerFoot"},[a("el-pagination",{attrs:{"current-page":t.page,"page-sizes":[15,20,30,40],"page-size":t.m_count,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.changeSize,"current-change":t.jump}})],1)],1)},staticRenderFns:[]}},417:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{accept:{type:String,default:"image/*"},tokenUrl:{type:String,default:"/common/uploadToken"},value:{type:String,require:!0}},data:function(){return{fileToken:{token:""}}},methods:{getToken:function(){var t=this;return this.$axios.get(this.tokenUrl).then(function(e){t.fileToken.token=e.data.info})},handle:function(t){this.$emit("input","https:"+t.info)}}}},419:function(t,e,a){t.exports={default:a(420),__esModule:!0}},420:function(t,e,a){var o=a(6),s=o.JSON||(o.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},422:function(t,e,a){e=t.exports=a(221)(!1),e.push([t.i,"",""])},678:function(t,e,a){var o=a(422);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a(222)("27f0faaf",o,!0,{})},682:function(t,e,a){function o(t){a(678)}var s=a(53)(a(417),a(685),o,"data-v-2f9c8226",null);t.exports=s.exports},685:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-upload",{ref:"upload",attrs:{action:"https://static.v6plus.com/api.php/upload/file","on-success":t.handle,data:t.fileToken,limit:1,"before-upload":t.getToken,"show-file-list":!1,accept:t.accept}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(t._s(""==t.value?"":"已上传"))])],1)},staticRenderFns:[]}},741:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(259),s=a.n(o),n=a(419),i=a.n(n),l=a(96),r=a.n(l),c=a(270),u=a.n(c),d=a(682),m=a.n(d),p={name:"",v4url:"http://",v6url:"",company:0,isHttps:0,isBoth:0,cert:"",pem:"",key:""},v={name:"",company:0,cert:"",pem:"",key:""},f={name:"",contact:"",tel:""},h=/^1\d{10}$/;e.default={data:function(){return{addComModal:!1,modComModal:!1,activeName:"first",addModal:!1,editdModal:!1,bindUser:"",bindId:"",modId:"",modComId:"",companyData:[],user:r()({},p),com:r()({},f),userData:[],modIsHttps:0,v6ComModal:!1,v6ComModalTitle:"",v6BindId:"",v6BindData:[],siteId:"",tokenCert:{token:""},tokenkey:{token:""},modTokenCert:{token:""},modTtokenkey:{token:""},mod:r()({},v),modCom:{name:"",contact:"",tel:""}}},methods:{bindV6:function(t){var e=this;this.siteId=t.id,this.v6ComModalTitle=t.name,this.v6ComModal=!0,0==this.v6BindData.length&&this.$axios.get("/user/v6addr/addrBrief").then(function(t){e.v6BindData=t.data})},v6bindAccount:function(){var t=this;this.$axios.post("/user/site/bind",{sid:this.siteId,vid:this.v6BindId}).then(function(e){t.$message({type:"success",message:"绑定成功!"}),t.v6ComModal=!1,t.$refs.user.reload()})},editComOpen:function(t){this.modComModal=!0,this.modCom.name=t.name,this.modCom.contact=t.contact,this.modCom.tel=t.tel,this.modComId=t.id},modComAccount:function(){var t=this;if(""!=this.modCom.tel&&!h.test(this.modCom.tel))return void this.$message({type:"warning",message:"手机号码错误!"});this.$axios.put("/user/site/company/"+this.modComId,this.modCom).then(function(e){t.$message({type:"success",message:"修改成功!"}),t.modComModal=!1,t.$refs.com.reload()})},comDel:function(t){var e=this;this.$confirm("此操作将删除该单位, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.delete("/user/site/company/"+t).then(function(t){e.$message({type:"success",message:"删除成功!"}),e.$refs.com.reload()})})},addComShow:function(){this.addComModal=!0},addComAccount:function(){var t=this;return""==this.com.name?void this.$message({type:"warning",message:"名称不能为空!"}):""==this.com.tel||h.test(this.com.tel)?void this.$axios.post("/user/site/company",this.com).then(function(e){t.$message({type:"success",message:"添加成功!"}),t.addComModal=!1,t.com={name:"",company:0,cert:"",v6url:""},t.$refs.com.reload(),t.companyData=[]}):void this.$message({type:"warning",message:"手机号码错误!"})},editOpen:function(t){this.editdModal=!0,this.modId=t.id,this.modIsHttps=t.isHttps,this.mod.name=t.name,this.mod.company=t.company,this.getCompany()},getCompany:function(){var t=this;0==this.companyData.length&&this.$axios.get("/user/site/companyBrief").then(function(e){t.companyData=e.data,t.companyData.unshift({id:0,name:"无"})})},editAccount:function(){var t=this;1==this.modIsHttps&&""!=this.mod.pem&&""!=this.mod.key&&(this.mod.cert=i()({cert:this.mod.pem,key:this.mod.key})),this.$axios.put("/user/site/site/"+this.modId,this.mod).then(function(e){t.$message({type:"success",message:"修改成功!"}),t.editdModal=!1,t.mod=r()({},v),t.$refs.user.reload()})},del:function(t){var e=this;this.$confirm("此操作将删除该网站, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.delete("/user/site/site/"+t).then(function(t){e.$message({type:"success",message:"删除成功!"}),e.$refs.user.reload()})})},bind:function(t){var e=this;this.bindModal=!0,this.bindId=t,this.$axios.get("/user/account/userbrief").then(function(t){e.userData=[];var a=!0,o=!1,n=void 0;try{for(var i,l=s()(t.data);!(a=(i=l.next()).done);a=!0){var r=i.value;e.userData.push({value:r.id,label:r.nickName})}}catch(t){o=!0,n=t}finally{try{!a&&l.return&&l.return()}finally{if(o)throw n}}})},bindAccount:function(){var t=this;this.$axios.post("/user/site/bind/"+this.bindId,{vid:this.bindId,sid:this.bindUser}).then(function(e){t.$message({type:"success",message:"绑定成功"}),t.bindModal=!1,t.$refs.user.reload()})},addShow:function(t){this.addModal=!0,this.user=p,this.getCompany()},addAccount:function(){var t=this;if(""==this.user.name)return void this.$message({message:"名称不能为空",type:"warning"});var e=/^(http|https)\:\/\//;if(""==this.user.v4url)return void this.$message({message:"V4域名不能为空，并且在开头添加http://或https://",type:"warning"});if(!e.test(this.user.v4url))return void this.$message({message:"请在开头添加http://或https://",type:"warning"});if(""==this.user.v6url)return void this.$message({type:"warning",message:"v6域名不能为空"});if(1==this.user.isHttps){if(""==this.user.pem||""==this.user.key)return void this.$message({message:"请上传证书文件！",type:"warning"});this.user.cert=i()({cert:this.user.pem,key:this.user.key})}this.$axios.post("/user/site/site",this.user).then(function(e){t.$message({message:"操作成功",type:"success"}),t.addModal=!1,t.user=r()({},p),t.$refs.user.reload()})}},components:{uTable:u.a,uUploader:m.a}}},765:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"g-box-content"},[a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"网站",name:"first"}},[a("div",[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple m-content-head"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"plus"},on:{click:function(e){t.addShow()}}},[t._v("添加网站"),a("i",{staticClass:"el-icon-plus"})])],1)])],1),t._v(" "),a("div",{staticClass:"v-table"},[a("h3",[t._v("网站列表")]),t._v(" "),a("u-table",{ref:"user",attrs:{url:"/user/site/site"}},[a("el-table-column",{attrs:{align:"center",prop:"name",label:"名称"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"v4url",label:"v4域名"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"v6url",label:"v6域名"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"v6num",label:"v6升级次数"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"isHttps",label:"是否是https",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.isHttps?a("el-tag",{attrs:{type:"success"}},[t._v("是")]):a("el-tag",{attrs:{type:"danger"}},[t._v("否")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"isBoth",label:"是否是https+http",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.online?a("el-tag",{attrs:{type:"success"}},[t._v("是")]):a("el-tag",{attrs:{type:"danger"}},[t._v("否")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"所属单位"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(null===e.row.company?"无":e.row.company))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"time",label:"添加时间",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){t.bindV6(e.row)}}},[t._v("V6升级")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){t.editOpen(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){t.del(e.row.id)}}},[t._v("删除")])]}}])})],1)],1)],1)]),t._v(" "),a("el-tab-pane",{attrs:{label:"单位",name:"second"}},[a("div",[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple m-content-head"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"plus"},on:{click:function(e){t.addComShow()}}},[t._v("添加单位"),a("i",{staticClass:"el-icon-plus"})])],1)])],1),t._v(" "),a("div",{staticClass:"v-table"},[a("h3",[t._v("单位列表")]),t._v(" "),a("u-table",{ref:"com",attrs:{url:"/user/site/company"}},[a("el-table-column",{attrs:{align:"center",prop:"name",label:"名称"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"contact",label:"联系人"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"tel",label:"手机号"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){t.editComOpen(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){t.comDel(e.row.id)}}},[t._v("删除")])]}}])})],1)],1)],1)])],1),t._v(" "),a("el-dialog",{attrs:{title:"添加网站",visible:t.addModal,width:"45%"},on:{"update:visible":function(e){t.addModal=e}}},[a("el-form",{attrs:{"label-width":"140px"}},[a("el-form-item",{attrs:{label:"网站名称："}},[a("el-input",{attrs:{placeholder:"请输入内容",maxlength:"20"},model:{value:t.user.name,callback:function(e){t.$set(t.user,"name",e)},expression:"user.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"v4域名："}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"开头必须是http://或者https://",placement:"top"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.user.v4url,callback:function(e){t.$set(t.user,"v4url",e)},expression:"user.v4url"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"v6域名："}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.user.v6url,callback:function(e){t.$set(t.user,"v6url",e)},expression:"user.v6url"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"所属单位："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.user.company,callback:function(e){t.$set(t.user,"company",e)},expression:"user.company"}},t._l(t.companyData,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"是否是https："}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:t.user.isHttps,callback:function(e){t.$set(t.user,"isHttps",e)},expression:"user.isHttps"}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.user.isHttps,expression:"user.isHttps==1"}]},[a("el-form-item",{attrs:{label:"https和http并存："}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:t.user.isBoth,callback:function(e){t.$set(t.user,"isBoth",e)},expression:"user.isBoth"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"证书上传："}},[a("u-uploader",{attrs:{accept:".pem"},model:{value:t.user.pem,callback:function(e){t.$set(t.user,"pem",e)},expression:"user.pem"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"秘钥上传："}},[a("u-uploader",{attrs:{accept:".key"},model:{value:t.user.key,callback:function(e){t.$set(t.user,"key",e)},expression:"user.key"}})],1)],1),t._v(" "),a("div",{staticClass:"v-modal-footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addAccount}},[t._v("添加")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"修改",visible:t.editdModal,width:"45%"},on:{"update:visible":function(e){t.editdModal=e}}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称："}},[a("el-input",{attrs:{placeholder:"请输入内容",maxlength:"20"},model:{value:t.mod.name,callback:function(e){t.$set(t.mod,"name",e)},expression:"mod.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"所属单位："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.mod.company,callback:function(e){t.$set(t.mod,"company",e)},expression:"mod.company"}},t._l(t.companyData,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.modIsHttps,expression:"modIsHttps==1"}]},[a("el-form-item",{attrs:{label:"证书上传："}},[a("u-uploader",{attrs:{accept:".pem"},model:{value:t.mod.pem,callback:function(e){t.$set(t.mod,"pem",e)},expression:"mod.pem"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"秘钥上传："}},[a("u-uploader",{attrs:{accept:".key"},model:{value:t.mod.key,callback:function(e){t.$set(t.mod,"key",e)},expression:"mod.key"}})],1)],1),t._v(" "),a("div",{staticClass:"v-modal-footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.editAccount}},[t._v("确认")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"添加单位",visible:t.addComModal,width:"45%"},on:{"update:visible":function(e){t.addComModal=e}}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称："}},[a("el-input",{attrs:{placeholder:"请输入内容",maxlength:"40"},model:{value:t.com.name,callback:function(e){t.$set(t.com,"name",e)},expression:"com.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系人："}},[a("el-input",{attrs:{placeholder:"请输入内容",maxlength:"10"},model:{value:t.com.contact,callback:function(e){t.$set(t.com,"contact",e)},expression:"com.contact"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"手机号："}},[a("el-input",{attrs:{placeholder:"请输入内容",maxlength:11},model:{value:t.com.tel,callback:function(e){t.$set(t.com,"tel",e)},expression:"com.tel"}})],1),t._v(" "),a("div",{staticClass:"v-modal-footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addComAccount}},[t._v("添加")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"修改单位",visible:t.modComModal,width:"45%"},on:{"update:visible":function(e){t.modComModal=e}}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称："}},[a("el-input",{attrs:{placeholder:"请输入内容",maxlength:"40"},model:{value:t.modCom.name,callback:function(e){t.$set(t.modCom,"name",e)},expression:"modCom.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系人："}},[a("el-input",{attrs:{placeholder:"请输入内容",maxlength:"10"},model:{value:t.modCom.contact,callback:function(e){t.$set(t.modCom,"contact",e)},expression:"modCom.contact"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"手机号："}},[a("el-input",{attrs:{placeholder:"请输入内容",maxlength:11},model:{value:t.modCom.tel,callback:function(e){t.$set(t.modCom,"tel",e)},expression:"modCom.tel"}})],1),t._v(" "),a("div",{staticClass:"v-modal-footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.modComAccount}},[t._v("确认")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"v6升级-"+t.v6ComModalTitle,visible:t.v6ComModal,width:"45%"},on:{"update:visible":function(e){t.v6ComModal=e}}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"v6地址："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.v6BindId,callback:function(e){t.v6BindId=e},expression:"v6BindId"}},t._l(t.v6BindData,function(e){return a("el-option",{key:e.id,attrs:{label:e.ipaddr,value:e.id}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.ipaddr))]),t._v(" "),a("span",{staticStyle:{float:"right"}},[t._v(t._s(e.desc.substr(0,10)))])])}))],1),t._v(" "),a("div",{staticClass:"v-modal-footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.v6bindAccount}},[t._v("确认")])],1)],1)],1)],1)},staticRenderFns:[]}}});